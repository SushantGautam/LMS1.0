{% load static %}
<div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true" id="create_chapter_modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h4 class="modal-title" id="exampleModalLabel"><b>Create Chapter</b>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </h4>
            </div>
            <div class="modal-body" id="create_chapter_modal_body">
            </div>
        </div>
    </div>
</div>

<div class="outerdiv">
    <div class="col-md-12 col-sm-12 col-xs-12 text-center">
        <h2 class="detailListHeader">Course Information</h2>
    </div>

    <div class="col-md-12 col-sm-12 col-xs-12">
        <hr class="header_hr" style="margin-bottom: 5px;margin-top: 5px;">
        <div class="col-md-6 col-sm-12 col-xs-12 no-padding">
            <h3 align="center"><b>{{ object.Course_Name }}</b></h3>
            <br>

            <img class="card-img-top" src="
                            {% if object.Course_Cover_File %}
                                /media/{{ object.Course_Cover_File }}
                            {% else %}
                                {% static 'images/course.jpg' %}
                            {% endif %}" alt="Card image cap" style="
                            display: block;
                            margin-left: auto;
                            margin-right: auto;
                            width: 50%;
                            max-height: 400px">

            <div class="courseDetailStyle1 row" style="margin-top: 10px">


                <div class="col-lg-6" style="font-size: 15px;">

                    <h5 align="center">
                        {% if topic %}
                        <a target="_blank" href="
                        {% if '/teachers' in request.path %}
                        {% url 'Teacher_Course_Forum' object.pk %}
                        {% elif '/students' in request.path %}
                        {% url 'Student_Course_Forum' object.pk %}
                        {% else %}
                        {% url 'Course_Forum' object.pk %}
                        {% endif %}">
                            <i class="fa fa-comment-o"></i> <b> FORUM </b>
                            {% else %}
                            {% if '/students' not in request.path %}
                            <a target="_blank" href="
                        {% if '/teachers' in request.path %}
                        {% url 'Teacher_Course_Forum' object.pk %}
                        {% else %}
                        {% url 'Course_Forum' object.pk %}
                        {% endif %}">
                                <i class="fa fa-comment-o"></i> <b> Add Forum </b> </a>
                            {% endif %}
                            {% endif %}

                    </h5>
                </div>
                {% if '/students' not in request.path %}
                <div class="col-md-6 col-sm-12 col-xs-12" style="margin-top: 10px;">
                    <a href="{% if '/teachers' in request.path %}
                    /teachers{{ object.get_update_url }}
                        {% else %}
                            {{ object.get_update_url }}
                        {% endif %}"><b><u>Edit Course</u></b></a>
                    <span style="float: right;">
                        <a id="{{ object.pk }}" class="course-confirm-delete"
                            style="color: rgb(255, 0, 0);cursor:pointer">Delete</a>
                    </span>
                    <form method="post" action="{% url 'courseinfo_delete' pk=object.pk %}"
                        id="deleteCourse{{ object.pk }}">
                        {% csrf_token %}
                        <!-- <input type="hidden" value="{{questions.pk}}" name="question_id"> -->
                        <input type="hidden" value="{{object.pk}}" name="course_id">
                    </form>
                </div>
                {% endif %}
            </div>
            <table class="table">

                <tr>
                    <td style="vertical-align: middle;">Difficulty</td>
                    <td>

                        <span id="rating"></span>


                    </td>
                </tr>
                <tr>
                    <td>Course Provider</td>
                    <td>{{ object.Course_Provider }}</td>
                </tr>
                <tr>
                    <td>Registered By</td>
                    <td>{{ object.Register_Agent }}</td>
                </tr>
                <tr>
                    <td>Status</td>
                    <td>
                        {% if object.Use_Flag == True %}
                        Active
                        {% elif object.Use_Flag == False %}
                        Deactivated
                        {% endif %}
                    </td>
                </tr>
            </table>
            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                <h4 align="center"><b>Course Description</b></h4>
                <p style="margin-left: 10px; overflow-wrap:break-word; "> {{ object.Course_Description }} </p>
                <hr>
            </div>

            <table class="table">

                <tr>
                    <td style="border-top:0 ">
                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                            Number of Quizes
                        </div>
                    </td>
                    <td style="border-top:0; ">
                        {{ quizcount.count }}
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                            Number of Survey
                        </div>
                    </td>
                    <td>
                        {{ surveycount.count }}
                    </td>
                </tr>
            </table>
            <!-- <p>

                <a class="btn btn-primary" data-toggle="collapse" href="#quizcollapse" role="button"
                    aria-expanded="false" aria-controls="quizcollapse">
                    {{ object.quiz_set.count }} Quizes
                </a>

            </p> -->
            <!-- <br> -->
            <!-- <p>
                <a class="btn btn-primary" data-toggle="collapse" href="#surveycollapse" role="button"
                    aria-expanded="false" aria-controls="surveycollapse">
                    {{ surveycount.count }} Surveys
                </a>

            </p> -->
            <!-- <div class="collapse" id="surveycollapse">
                <div class="card card-body">
                    {% for each in surveycount %}
                    <a href="/survey/surveyinfo/detail/{{ each.pk }}"> {{ each.Survey_Title }}</a>
                    {% endfor %}
                </div>
            </div> -->


        </div>
        <div class="col-md-6 col-sm-12 xol-xs-12">
            <div class="col-md-12 col-sm-12 xol-xs-12">
                <div class="col-md-8 col-sm-12 col-xs-12 text-center">
                    <h2 class="subHeader">Chapters</h2>


                </div>

                {% if '/students' not in request.path %}
                <div class="col-md-4 col-sm-12 col-xs-12 text-center" style="margin-top: 10px">
                    <button type="button" class="btn-sm btn-success" data-toggle="modal" data-target="#exampleModal1"
                        id="add-newchapter-btn">
                        Create New Chapter
                    </button>
                </div>
                {% endif %}
                <div class="col-md-12 col-sm-12 xol-xs-12">
                    <script> var lastchapter = 0;</script>
                    {% for o in chapters %}
                    <div class="col-md-12 col-sm-12 col-xs-12 leftborder" style=" margin: 5px;">
                        <div class="col-md-8 col-sm-8 col-xs-12">
                            <h5 style="padding-top: 2px; color: #000000"> Chapter No: {{ o.Chapter_No }}</h5>
                            <h4>
                                <b style="color: #000000">{{ o.Chapter_Name }}</b>
                            </h4>
                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12">
                            <a href="{% if '/students' in request.path %}
                                {{ o.student_get_absolute_url }}
                            {% elif '/teachers' in request.path %}
                                {{ o.teacher_get_absolute_url }}
                            {% else %}
                               {{ o.get_absolute_url }}
                            {% endif %}">
                                <button type="button" style="float: right;width:150px;height:25px;border: 1px solid #017a9b;color:#017a9b;background-color: white;border-radius: 4px;
                                margin-top: 20px;margin-bottom: 10px;">View Chapter &nbsp;<i
                                        class="fa fa-arrow-right"></i>
                                </button>
                            </a>
                        </div>

                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <hr style="margin-top: 5px; margin-bottom: 5px;">
                            <p>{{ o.Summary }}</p>
                        </div>
                    </div>
                    <script> var lastchapter = {{ o.Chapter_No }};</script>

                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% block customjss %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>

    if (parseInt('{{object.Course_Level}}'))
        for (j = 0; j < parseInt('{{object.Course_Level}}'); j++) {
            $('#rating').append("&nbsp;<i class='fa fa-star' style='color:#f5ba00'></i>");
        }
    else
        $('#rating').append("Rating not defined");

</script>
<script src=" {% static 'vendorsx/jQuery-Smart-Wizard/js/jquery.smartWizard.js' %}"></script>
<script>
    $('#myModal').on('shown.bs.modal', function () {
        $('#myInput').trigger('focus')
    });

    $(document).on('click', '.course-confirm-delete', function () {
        ans = confirm('Are you sure you want to delete this Course?');
        if (ans == true) {
            $(`#deleteCourse${this.id}`).submit();
        } else {
            return false;
        }
    });


    $('#add-newchapter-btn').on('click', function () {
        $('#create_chapter_modal_body').empty();
        $('#create_chapter_modal_body').append(
            `<input type="hidden" name="Course_Code" id="id_Course_Code" value="{{ object.pk }}"
               class="select form-control">`
        )
        $.ajax({
            type: "GET",
            url: "{% url 'chapterinfo_create_ajax' %}",  // URL to your view that serves new info
            success: function (response) {
                $('#create_chapter_modal_body').append(response);
            },
            error: function () {
                console.log('Error in generating chapter create form')
            },
            complete: function () {
                $(".se-pre-con-ajax").fadeOut("fast");
                $("#id_Chapter_No").val(lastchapter + 1);
            }
        });


    });
</script>
{% endblock %}