{% load static %}

<small class="text-info">Please make sure that the name is not defined, before creating a new one.</small><br>
<small>View Detail about Session Name List <b><a href="{% url 'sessioninfo_list' %}">here</a></b></small><br><br>
<form method="post" id="ajaxsessionform">
    {% csrf_token %}
    <div class="form-group">
        <label for="id_Session_Name">Session Name</label>
        <input type="text" class="form-control" name="Session_Name" maxlength="150" id="id_Session_Name" required>
    </div>
    <span id="error-msg-span" class="text-danger"></span>
    <div id="div_id_Description" class="form-group">
        <label for="id_Description" class="control-label">
            Description
        </label>
        <div class="controls ">
            <textarea name="Description" cols="40" id="id_Description" rows="6"
                class="textarea form-control"></textarea>
        </div>
    </div>
    <input type="hidden" id="id_Use_Flag" name="Use_Flag" value="True">
    <input type="hidden" name="Center_Code" id="id_Center_Code" value="{{ request.user.Center_Code.id }}"
        class="select form-control">
    <div class="submitButton text-center pt-3">
        <button class="btn btn-primary" id="ajaxsessionsubmit-btn">Submit</button>
        <button type="button" class="btn btn-secondary close-btn" data-dismiss="modal" id="close-btn">Close</button>
    </div>
</form>

<script>
    $("#ajaxsessionform").submit(function (e) {
        e.preventDefault(); // avoid to execute the actual submit of the form.
        $.ajax({
            url: "{% url 'sessioninfo_create_ajax' %}",  // URL to your view that serves new info
            data: $(this).serialize(), // get the form data
            type: $(this).attr('method'), // GET or POST
            success: function (response) {
                var id_Session_Name = $('#id_Session_Name').val();
                $(".close-btn").click();
                $('#id_Inning_Name').append(`
                    <option value="` + response.pk + `" selected>` + id_Session_Name + `</option>
                `);
            },
            error: function () {
                console.log('Error in posting session create form')
            }
        });
    });
</script>